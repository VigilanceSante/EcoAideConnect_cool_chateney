{% extends layout_path %}
{% load static %}

{% block content %}
<div class="container">
  <h1 class="text-center my-4">Les binômes de la semaine</h1>

  <!-- Affichage des Les binômes de la semaines -->
  <div id="buddies-list" class="row g-4">
    {% for pair in buddy_pairs %}
      <div class="col-md-6">
        <div class="card shadow-sm">
          <div class="card-body">
            <!-- Affichage pour l'AIDÉ -->
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h5 class="card-title mb-0">
                {{ pair.person.first_name }} {{ pair.person.last_name }}
                <span class="badge bg-info">Aidé</span>
              </h5>
            </div>
            <p><i class="fa fa-envelope"></i> <strong>Email :</strong> {{ pair.person.email }}</p>
            <p><i class="fa fa-phone"></i> <strong>Téléphone :</strong> {{ pair.person.phone }}</p>
            <p><i class="fa fa-calendar-alt"></i> <strong>Disponibilité :</strong> {{ pair.person.start_date }} - {{ pair.person.end_date }}<br>
              <strong>Plages :</strong>
              {% if pair.person_slots %}
                {{ pair.person_slots|join:", " }}
              {% else %}
                Aucune plage disponible
              {% endif %}
            </p>
            <hr>
            <!-- Affichage pour l'AIDANT -->
            <h5 class="card-title">
              {{ pair.buddy.first_name }} {{ pair.buddy.last_name }}
              <span class="badge bg-success">Aidant</span>
            </h5>
            <p><i class="fa fa-envelope"></i> <strong>Email :</strong> {{ pair.buddy.email }}</p>
            <p><i class="fa fa-phone"></i> <strong>Téléphone :</strong> {{ pair.buddy.phone }}</p>
            <p><i class="fa fa-calendar-alt"></i> <strong>Disponibilité :</strong> {{ pair.buddy.start_date }} - {{ pair.buddy.end_date }}<br>
              <strong>Plages :</strong>
              {% if pair.buddy_slots %}
                {{ pair.buddy_slots|join:", " }}
              {% else %}
                Aucune plage disponible
              {% endif %}
            </p>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

  <!-- Pagination -->
  {% if buddy_pairs.has_other_pages %}
    <nav aria-label="Pagination des paires">
      <ul class="pagination justify-content-center mt-4">
        {% if buddy_pairs.has_previous %}
          <li class="page-item">
            <a class="page-link" href="?page={{ buddy_pairs.previous_page_number }}&{{ request.GET.urlencode }}" aria-label="Précédent">
              <span aria-hidden="true">&laquo;</span>
            </a>
          </li>
        {% endif %}

        {% for num in buddy_pairs.paginator.page_range %}
          {% if num >= buddy_pairs.number|add:"-2" and num <= buddy_pairs.number|add:"2" %}
            <li class="page-item {% if buddy_pairs.number == num %}active{% endif %}">
              <a class="page-link" href="?page={{ num }}&{{ request.GET.urlencode }}">{{ num }}</a>
            </li>
          {% endif %}
        {% endfor %}

        {% if buddy_pairs.has_next %}
          <li class="page-item">
            <a class="page-link" href="?page={{ buddy_pairs.next_page_number }}&{{ request.GET.urlencode }}" aria-label="Suivant">
              <span aria-hidden="true">&raquo;</span>
            </a>
          </li>
        {% endif %}
      </ul>
    </nav>
  {% endif %}
</div>

{% endblock %}